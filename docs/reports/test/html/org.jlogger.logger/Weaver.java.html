<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Weaver.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Jlogger</a> &gt; <a href="index.source.html" class="el_package">org.jlogger.logger</a> &gt; <span class="el_source">Weaver.java</span></div><h1>Weaver.java</h1><pre class="source lang-java linenums">package org.jlogger.logger;

import org.aspectj.bridge.IMessage;
import org.aspectj.bridge.MessageHandler;
import org.aspectj.tools.ajc.Main;

import java.io.*;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.ArrayList;
import java.util.Enumeration;
import java.util.jar.JarEntry;
import java.util.jar.JarFile;
import java.util.jar.JarOutputStream;


public class Weaver {
<span class="fc" id="L19">    private final String workDir = System.getProperty(&quot;user.home&quot;) + System.getProperty(&quot;file.separator&quot;) + &quot;.jloggertemp&quot;;</span>
<span class="fc" id="L20">    private final String aroundMethodPlaceHolder = &quot;execution($2 $1(..))&quot;;</span>
<span class="fc" id="L21">    private final String aroundFieldSetPlaceHolder = &quot;set($2 $1)&quot;;</span>
<span class="fc" id="L22">    private final String aroundFieldGetPlaceHolder = &quot;get($2 $1)&quot;;</span>

<span class="fc" id="L24">    private final String[] returnTypesArray = {&quot;Integer&quot;, &quot;int&quot;, &quot;Long&quot;, &quot;long&quot;, &quot;Float&quot;, &quot;float&quot;, &quot;Double&quot;, &quot;double&quot;, &quot;String&quot;, &quot;Boolean&quot;, &quot;boolean&quot;, &quot;Byte&quot;, &quot;byte&quot;, &quot;Short&quot;, &quot;short&quot;, &quot;Character&quot;, &quot;char&quot;};</span>
    private final MessageHandler messageHandler;
    public String logFilePath;
    public String jarInputPath;
<span class="fc" id="L28">    private String lastWeavedJarPath = &quot;&quot;;</span>

<span class="fc" id="L30">    public Weaver(String logFilePath, String jarInputPath) throws IOException {</span>
        // If the temp directory is not present in workDir, create it

<span class="fc bfc" id="L33" title="All 2 branches covered.">        if (new java.io.File(workDir).exists()) {</span>
<span class="fc" id="L34">                Files.walk(Paths.get(workDir))</span>
<span class="fc" id="L35">                        .map(Path::toFile)</span>
<span class="fc" id="L36">                        .forEach(File::delete);</span>

        }
<span class="fc" id="L39">        new java.io.File(workDir).mkdir();</span>

<span class="fc" id="L41">        this.logFilePath = logFilePath;</span>
<span class="fc" id="L42">        this.jarInputPath = jarInputPath;</span>
        // Create Imessage holder
<span class="fc" id="L44">        this.messageHandler = new MessageHandler(true);</span>

<span class="fc" id="L46">    }</span>

    private static void addFilesToJar(String sourceFolder, JarOutputStream jos, String parentFolder) throws IOException {
<span class="fc" id="L49">        File folder = new File(sourceFolder);</span>

<span class="fc bfc" id="L51" title="All 2 branches covered.">        for (File file : folder.listFiles()) {</span>
<span class="fc" id="L52">            String entryName = parentFolder + file.getName();</span>
<span class="fc bfc" id="L53" title="All 2 branches covered.">            if (file.isDirectory()) {</span>
<span class="fc" id="L54">                entryName += &quot;/&quot;;</span>
<span class="fc" id="L55">                jos.putNextEntry(new JarEntry(entryName));</span>
<span class="fc" id="L56">                jos.closeEntry();</span>
<span class="fc" id="L57">                addFilesToJar(file.getAbsolutePath(), jos, entryName);</span>
            } else {
<span class="fc" id="L59">                jos.putNextEntry(new JarEntry(entryName));</span>
<span class="fc" id="L60">                byte[] buffer = new byte[1024];</span>
                int bytesRead;
<span class="fc" id="L62">                FileInputStream fileInputStream = new FileInputStream(file);</span>
<span class="fc bfc" id="L63" title="All 2 branches covered.">                while ((bytesRead = fileInputStream.read(buffer)) != -1) {</span>
<span class="fc" id="L64">                    jos.write(buffer, 0, bytesRead);</span>
                }
<span class="fc" id="L66">                fileInputStream.close();</span>
<span class="fc" id="L67">                jos.closeEntry();</span>
            }
        }
<span class="fc" id="L70">    }</span>

    public boolean weaveMethodExecutionTime(ArrayList&lt;String&gt; methodsRegex) {
        try {
            // Get the file contents of ExecutionTimeAspect.java from the resources folder
<span class="fc" id="L75">            InputStream executionTimeAspect = Weaver.class.getClassLoader().getResourceAsStream(&quot;ExecutionTimeAspect.java&quot;);</span>

<span class="fc" id="L77">            String executionTimeAspectContents = new String(executionTimeAspect.readAllBytes());</span>
            // Replace the placeholder in the aspect with the log file path

<span class="fc" id="L80">            executionTimeAspectContents = executionTimeAspectContents.replace(&quot;${logFileName}&quot;, logFilePath);</span>
<span class="fc" id="L81">            executionTimeAspectContents = executionTimeAspectContents.replace(&quot;${MethodNames}&quot;, prepareFinalRegex(methodsRegex, aroundMethodPlaceHolder, &quot;*&quot;));</span>
<span class="fc" id="L82">            System.out.println(prepareFinalRegex(methodsRegex, aroundMethodPlaceHolder, &quot;*&quot;));</span>
<span class="fc bfc" id="L83" title="All 2 branches covered.">            for (String methodRegex : methodsRegex) {</span>
<span class="fc" id="L84">                System.out.println(&quot;REGEX: &quot; + methodRegex);</span>
<span class="fc" id="L85">            }</span>

            // Write the modified aspect to the temp directory
<span class="fc" id="L88">            FileWriter writer = new FileWriter(workDir + System.getProperty(&quot;file.separator&quot;) + &quot;ExecutionTimeAspect.java&quot;);</span>
<span class="fc" id="L89">            writer.write(executionTimeAspectContents);</span>
<span class="fc" id="L90">            writer.close();</span>

<span class="fc" id="L92">            String outputFileName = this.jarInputPath.replace(&quot;.jar&quot;, &quot;_weaved.jar&quot;);</span>
            //Set output file location without full path
<span class="fc" id="L94">            outputFileName = outputFileName.substring(outputFileName.lastIndexOf(System.getProperty(&quot;file.separator&quot;)) + 1);</span>
<span class="fc" id="L95">            System.out.println(&quot;Output file name: &quot; + outputFileName);</span>
<span class="fc" id="L96">            weaveJarFile(jarInputPath, workDir + System.getProperty(&quot;file.separator&quot;) + &quot;ExecutionTimeAspect.java&quot;, workDir + System.getProperty(&quot;file.separator&quot;) + outputFileName);</span>
<span class="fc" id="L97">            this.lastWeavedJarPath = workDir + System.getProperty(&quot;file.separator&quot;) + outputFileName;</span>
<span class="fc" id="L98">            jarInputPath = this.lastWeavedJarPath;</span>
<span class="fc" id="L99">            System.out.println(&quot;LAST WEAVED JAR PATH: &quot; + this.lastWeavedJarPath);</span>

<span class="fc" id="L101">            return true;</span>
<span class="fc" id="L102">        } catch (Exception e) {</span>
<span class="fc" id="L103">            System.err.println(&quot;Some unexpected error occurred while weaving the jar. Check the method names and try again&quot;);</span>
<span class="fc" id="L104">            return false;</span>
        }
    }

    public boolean weaverMethodProfiler(ArrayList&lt;String&gt; methodsRegex) {
        try {
            // Get the file contents of ExecutionTimeAspect.java from the resources folder
<span class="fc" id="L111">            InputStream methodProfilerAspect = Weaver.class.getClassLoader().getResourceAsStream(&quot;MethodProfilerAspect.java&quot;);</span>

<span class="fc" id="L113">            String methodProfilerAspectContents = new String(methodProfilerAspect.readAllBytes());</span>
            // Replace the placeholder in the aspect with the log file path

<span class="fc" id="L116">            methodProfilerAspectContents = methodProfilerAspectContents.replace(&quot;${logFileName}&quot;, logFilePath);</span>
<span class="fc" id="L117">            methodProfilerAspectContents = methodProfilerAspectContents.replace(&quot;${MethodNames}&quot;, prepareFinalRegex(methodsRegex, aroundMethodPlaceHolder, &quot;*&quot;));</span>

            // Write the modified aspect to the temp directory
<span class="fc" id="L120">            FileWriter writer = new FileWriter(workDir + System.getProperty(&quot;file.separator&quot;) + &quot;MethodProfilerAspect.java&quot;);</span>
<span class="fc" id="L121">            writer.write(methodProfilerAspectContents);</span>
<span class="fc" id="L122">            writer.close();</span>
<span class="fc" id="L123">            String outputFileName = this.jarInputPath.replace(&quot;.jar&quot;, &quot;_weaved.jar&quot;);</span>
            //Set output file location without full path
<span class="fc" id="L125">            outputFileName = outputFileName.substring(outputFileName.lastIndexOf(System.getProperty(&quot;file.separator&quot;)) + 1);</span>
<span class="fc" id="L126">            weaveJarFile(jarInputPath, workDir + System.getProperty(&quot;file.separator&quot;) + &quot;MethodProfilerAspect.java&quot;, workDir + System.getProperty(&quot;file.separator&quot;) + outputFileName);</span>
<span class="fc" id="L127">            this.lastWeavedJarPath = workDir + System.getProperty(&quot;file.separator&quot;) + outputFileName;</span>
<span class="fc" id="L128">            jarInputPath = this.lastWeavedJarPath;</span>
<span class="fc" id="L129">            return true;</span>
<span class="fc" id="L130">        } catch (Exception e) {</span>
<span class="fc" id="L131">            e.printStackTrace();</span>
<span class="fc" id="L132">            return false;</span>
        }
    }

    public boolean weaveLogging(ArrayList&lt;String&gt; methodsRegex, ArrayList&lt;String&gt; fieldsRegex) {
        try {
            // Get the file contents of LoggingAspect.java from the resources folder
<span class="fc" id="L139">            InputStream LoggingAspect = Weaver.class.getClassLoader().getResourceAsStream(&quot;LoggingAspect.java&quot;);</span>
<span class="fc" id="L140">            String LoggingAspectContents = new String(LoggingAspect.readAllBytes());</span>
            // Replace the placeholder in the aspect with the log file path

<span class="fc" id="L143">            LoggingAspectContents = LoggingAspectContents.replace(&quot;${logFileName}&quot;, logFilePath);</span>
<span class="fc" id="L144">            LoggingAspectContents = LoggingAspectContents.replace(&quot;${MethodNames}&quot;, prepareFinalRegex(methodsRegex, aroundMethodPlaceHolder, &quot;*&quot;));</span>
<span class="fc" id="L145">            LoggingAspectContents = LoggingAspectContents.replace(&quot;${FieldSetNames}&quot;, prepareFinalRegex(fieldsRegex, aroundFieldSetPlaceHolder, &quot;*&quot;));</span>
<span class="fc" id="L146">            LoggingAspectContents = LoggingAspectContents.replace(&quot;${FieldGetNames}&quot;, prepareFinalRegex(fieldsRegex, aroundFieldGetPlaceHolder, &quot;*&quot;));</span>

            // Write the modified aspect to the temp directory
<span class="fc" id="L149">            FileWriter writer = new FileWriter(workDir + System.getProperty(&quot;file.separator&quot;) + &quot;LoggingAspect.java&quot;);</span>
<span class="fc" id="L150">            writer.write(LoggingAspectContents);</span>
<span class="fc" id="L151">            writer.close();</span>
<span class="fc" id="L152">            String outputFileName = this.jarInputPath.replace(&quot;.jar&quot;, &quot;_weaved.jar&quot;);</span>
            //Set output file location without full path
<span class="fc" id="L154">            outputFileName = outputFileName.substring(outputFileName.lastIndexOf(System.getProperty(&quot;file.separator&quot;)) + 1);</span>
<span class="fc" id="L155">            weaveJarFile(jarInputPath, workDir + System.getProperty(&quot;file.separator&quot;) + &quot;LoggingAspect.java&quot;, workDir + System.getProperty(&quot;file.separator&quot;) + outputFileName);</span>
<span class="fc" id="L156">            this.lastWeavedJarPath = workDir + System.getProperty(&quot;file.separator&quot;) + outputFileName;</span>
<span class="fc" id="L157">            jarInputPath = this.lastWeavedJarPath;</span>
<span class="fc" id="L158">            return true;</span>
<span class="fc" id="L159">        } catch (Exception e) {</span>
<span class="fc" id="L160">            e.printStackTrace();</span>
<span class="fc" id="L161">            return false;</span>
        }
    }

    public boolean weaverParallelize(ArrayList&lt;String&gt; methodsRegex) {
        try {
            // Get the file contents of ExecutionTimeAspect.java from the resources folder
<span class="fc" id="L168">            InputStream parallelizeAspect = Weaver.class.getClassLoader().getResourceAsStream(&quot;ParallelizeAspect.java&quot;);</span>
<span class="fc" id="L169">            String parallelizeAspectContents = new String(parallelizeAspect.readAllBytes());</span>

<span class="fc" id="L171">            parallelizeAspectContents = parallelizeAspectContents.replace(&quot;${logFileName}&quot;, logFilePath);</span>
<span class="fc" id="L172">            parallelizeAspectContents = parallelizeAspectContents.replace(&quot;${MethodNames}&quot;, prepareFinalRegex(methodsRegex, aroundMethodPlaceHolder, &quot;*&quot;));</span>

            // Write the  aspect to the temp directory
<span class="fc" id="L175">            FileWriter writer = new FileWriter(workDir + System.getProperty(&quot;file.separator&quot;) + &quot;ParallelizeAspect.java&quot;);</span>
<span class="fc" id="L176">            writer.write(parallelizeAspectContents);</span>
<span class="fc" id="L177">            writer.close();</span>

<span class="fc" id="L179">            String outputFileName = this.jarInputPath.replace(&quot;.jar&quot;, &quot;_weaved.jar&quot;);</span>
            //Set output file location without full path
<span class="fc" id="L181">            outputFileName = outputFileName.substring(outputFileName.lastIndexOf(System.getProperty(&quot;file.separator&quot;)) + 1);</span>
<span class="fc" id="L182">            weaveJarFile(jarInputPath, workDir + System.getProperty(&quot;file.separator&quot;) + &quot;ParallelizeAspect.java&quot;, workDir + System.getProperty(&quot;file.separator&quot;) + outputFileName);</span>
<span class="fc" id="L183">            this.lastWeavedJarPath = workDir + System.getProperty(&quot;file.separator&quot;) + outputFileName;</span>
<span class="fc" id="L184">            jarInputPath = this.lastWeavedJarPath;</span>
<span class="fc" id="L185">            return true;</span>
<span class="fc" id="L186">        } catch (Exception e) {</span>
<span class="fc" id="L187">            e.printStackTrace();</span>
<span class="fc" id="L188">            return false;</span>
        }
    }

    public boolean weaverCaching(ArrayList&lt;String&gt; methodsRegex) {
        try {
            // Get the file contents of ExecutionTimeAspect.java from the resources folder
<span class="fc" id="L195">            InputStream cachingAspect = Weaver.class.getClassLoader().getResourceAsStream(&quot;CachingAspect.java&quot;);</span>
<span class="fc" id="L196">            String cachingAspectContents = new String(cachingAspect.readAllBytes());</span>

<span class="fc" id="L198">            cachingAspectContents = cachingAspectContents.replace(&quot;${logFileName}&quot;, logFilePath);</span>

            // loop over returnTypesArray
<span class="fc bfc" id="L201" title="All 2 branches covered.">            for (String returnType : returnTypesArray) {</span>
<span class="fc" id="L202">                String methodName = &quot;${MethodNames&quot; + returnType + &quot;}&quot;;</span>
<span class="fc" id="L203">                cachingAspectContents = cachingAspectContents.replace(methodName, prepareFinalRegex(methodsRegex, aroundMethodPlaceHolder, returnType));</span>
            }

            // Write the  aspect to the temp directory
<span class="fc" id="L207">            FileWriter writer = new FileWriter(workDir + System.getProperty(&quot;file.separator&quot;) + &quot;CachingAspect.java&quot;);</span>
<span class="fc" id="L208">            writer.write(cachingAspectContents);</span>
<span class="fc" id="L209">            writer.close();</span>

<span class="fc" id="L211">            String outputFileName = this.jarInputPath.replace(&quot;.jar&quot;, &quot;_weaved.jar&quot;);</span>
            //Set output file location without full path
<span class="fc" id="L213">            outputFileName = outputFileName.substring(outputFileName.lastIndexOf(System.getProperty(&quot;file.separator&quot;)) + 1);</span>
<span class="fc" id="L214">            weaveJarFile(jarInputPath, workDir + System.getProperty(&quot;file.separator&quot;) + &quot;CachingAspect.java&quot;, workDir + System.getProperty(&quot;file.separator&quot;) + outputFileName);</span>
<span class="fc" id="L215">            this.lastWeavedJarPath = workDir + System.getProperty(&quot;file.separator&quot;) + outputFileName;</span>
<span class="fc" id="L216">            jarInputPath = this.lastWeavedJarPath;</span>
<span class="fc" id="L217">            return true;</span>
<span class="fc" id="L218">        } catch (Exception e) {</span>
<span class="fc" id="L219">            e.printStackTrace();</span>
<span class="fc" id="L220">            return false;</span>
        }
    }

    public boolean saveWeavedJar(String path) {
        try {
<span class="fc" id="L226">            java.nio.file.Files.copy(new java.io.File(this.lastWeavedJarPath).toPath(), new java.io.File(path).toPath(), java.nio.file.StandardCopyOption.REPLACE_EXISTING);</span>
<span class="fc" id="L227">            return true;</span>
<span class="fc" id="L228">        } catch (IOException e) {</span>
<span class="fc" id="L229">            e.printStackTrace();</span>
<span class="fc" id="L230">            return false;</span>
        }
    }

    public boolean extractAspectjrtToJar() {
        try {
<span class="fc" id="L236">            ClassLoader classLoader = Weaver.class.getClassLoader();</span>
<span class="fc" id="L237">            InputStream inputStream = classLoader.getResourceAsStream(&quot;aspectjrt&quot;);</span>
            //Copy this file to working directory first
<span class="fc" id="L239">            java.nio.file.Files.copy(inputStream, new java.io.File(workDir + System.getProperty(&quot;file.separator&quot;) + &quot;aspectjrt&quot;).toPath(), java.nio.file.StandardCopyOption.REPLACE_EXISTING);</span>
<span class="fc" id="L240">            String inputJarPath = this.lastWeavedJarPath;</span>
<span class="fc" id="L241">            String outputJarPath = this.lastWeavedJarPath.replace(&quot;.jar&quot;, &quot;_aspectjrt.jar&quot;);</span>
            // Copy the contents of the input jar to the output jar
<span class="fc" id="L243">            JarFile inputJar = new JarFile(inputJarPath);</span>
<span class="fc" id="L244">            JarOutputStream outputJar = new JarOutputStream(new FileOutputStream(outputJarPath));</span>
<span class="fc" id="L245">            String JarExtractPath = workDir + System.getProperty(&quot;file.separator&quot;) + &quot;JarExtract&quot;;</span>
            // If the path exists, delete it
<span class="fc bfc" id="L247" title="All 2 branches covered.">            if (new java.io.File(JarExtractPath).exists()) {</span>
<span class="fc" id="L248">                new java.io.File(JarExtractPath).delete();</span>
            }
            // Create the path
<span class="fc" id="L251">            new java.io.File(JarExtractPath).mkdir();</span>
            // Extract the aspectjrt to the JarExtract directory
<span class="fc" id="L253">            JarFile aspectjrtJar = new JarFile(workDir + System.getProperty(&quot;file.separator&quot;) + &quot;aspectjrt&quot;);</span>
<span class="fc" id="L254">            Enumeration&lt;JarEntry&gt; entries = aspectjrtJar.entries();</span>
<span class="fc bfc" id="L255" title="All 2 branches covered.">            while (entries.hasMoreElements()) {</span>
<span class="fc" id="L256">                JarEntry entry = entries.nextElement();</span>
<span class="pc bpc" id="L257" title="1 of 4 branches missed.">                if (entry.getName().contains(&quot;META-INF&quot;) || entry.getName().contains(&quot;MANIFEST.MF&quot;)) {</span>
<span class="nc" id="L258">                    continue;</span>
                }
<span class="fc bfc" id="L260" title="All 2 branches covered.">                if (entry.isDirectory()) {</span>
<span class="fc" id="L261">                    new java.io.File(JarExtractPath + System.getProperty(&quot;file.separator&quot;) + entry.getName()).mkdir();</span>
                } else {
<span class="fc" id="L263">                    Files.createDirectories(new java.io.File(JarExtractPath + System.getProperty(&quot;file.separator&quot;) + entry.getName()).toPath().getParent());</span>
<span class="fc" id="L264">                    java.nio.file.Files.copy(aspectjrtJar.getInputStream(entry), new java.io.File(JarExtractPath + System.getProperty(&quot;file.separator&quot;) + entry.getName()).toPath(), java.nio.file.StandardCopyOption.REPLACE_EXISTING);</span>
                }
<span class="fc" id="L266">            }</span>

            // Extract the input jar to the JarExtract directory
<span class="fc" id="L269">            entries = inputJar.entries();</span>
<span class="fc bfc" id="L270" title="All 2 branches covered.">            while (entries.hasMoreElements()) {</span>
<span class="fc" id="L271">                JarEntry entry = entries.nextElement();</span>
<span class="pc bpc" id="L272" title="1 of 2 branches missed.">                if (entry.isDirectory()) {</span>
                    // If the directory does not exist, create it
<span class="nc bnc" id="L274" title="All 2 branches missed.">                    if (!new java.io.File(JarExtractPath + System.getProperty(&quot;file.separator&quot;) + entry.getName()).exists()) {</span>
<span class="nc" id="L275">                        new java.io.File(JarExtractPath + System.getProperty(&quot;file.separator&quot;) + entry.getName()).mkdir();</span>
                    }
                } else {
<span class="fc" id="L278">                    Files.createDirectories(new java.io.File(JarExtractPath + System.getProperty(&quot;file.separator&quot;) + entry.getName()).toPath().getParent());</span>
<span class="fc" id="L279">                    java.nio.file.Files.copy(inputJar.getInputStream(entry), new java.io.File(JarExtractPath + System.getProperty(&quot;file.separator&quot;) + entry.getName()).toPath(), java.nio.file.StandardCopyOption.REPLACE_EXISTING);</span>
                }
<span class="fc" id="L281">            }</span>
            // Put everything inside the JarExtract directory to the output jar

<span class="fc" id="L284">            addFilesToJar(JarExtractPath, outputJar, &quot;&quot;);</span>

<span class="fc" id="L286">            inputJar.close();</span>
<span class="fc" id="L287">            outputJar.close();</span>

<span class="fc" id="L289">            aspectjrtJar.close();</span>
<span class="fc" id="L290">            this.lastWeavedJarPath = outputJarPath;</span>
<span class="fc" id="L291">            return true;</span>
<span class="fc" id="L292">        } catch (Exception e) {</span>
<span class="fc" id="L293">            e.printStackTrace();</span>
<span class="fc" id="L294">            return false;</span>
        }
    }

    private String prepareFinalRegex(ArrayList&lt;String&gt; methodsRegex, String PlaceHolder, String returnType) {

<span class="fc" id="L300">        System.out.println(PlaceHolder);</span>

<span class="fc" id="L302">        String finalRegex = &quot;&quot;;</span>
<span class="fc bfc" id="L303" title="All 2 branches covered.">        for (String regex : methodsRegex) {</span>
<span class="fc" id="L304">            finalRegex += PlaceHolder.replace(&quot;$1&quot;, regex).replace(&quot;$2&quot;, returnType) + &quot; || &quot;;</span>
<span class="fc" id="L305">        }</span>
<span class="fc" id="L306">        System.out.println(finalRegex.substring(0, finalRegex.length() - 4));</span>
<span class="fc" id="L307">        System.out.flush();</span>

<span class="fc" id="L309">        return finalRegex.substring(0, finalRegex.length() - 4);    // Remove the last &quot; || &quot;</span>
    }

    private boolean weaveJarFile(String jarFilePath, String aspectFilePath, String outjarPath) throws Exception {
<span class="fc" id="L313">        System.out.println(&quot;JARFILEPATH: &quot; + jarFilePath);</span>
<span class="fc" id="L314">        System.out.println(&quot;ASPECTFILEPATH: &quot; + aspectFilePath);</span>
<span class="fc" id="L315">        System.out.println(&quot;OUTJARPATH: &quot; + outjarPath);</span>

<span class="fc" id="L317">        String[] args = {&quot;-source&quot;, &quot;1.8&quot;, &quot;-target&quot;, &quot;1.8&quot;, &quot;-inpath&quot;, jarFilePath, aspectFilePath, &quot;-outjar&quot;, outjarPath};</span>
<span class="fc" id="L318">        Main main = new Main();</span>
<span class="fc" id="L319">        main.run(args, this.messageHandler);</span>
        // Print the messages
<span class="fc bfc" id="L321" title="All 2 branches covered.">        for (IMessage message : this.messageHandler.getMessages(null, true)) {</span>
<span class="fc" id="L322">            System.out.println(message.toString());</span>
        }
<span class="fc" id="L324">        return true;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>